from __future__ import annotations

from pathlib import Path

# HAND CONFIG PARAMETERS

## Number of joints. Should match other hand configs
NUM_JOINTS = 21

## Names of the joints in the order in the format used by the hand pose model
JOINT_NAME = (
    "Wrist",
    "Thumb_1",
    "Thumb_2",
    "Thumb_3",
    "Thumb_4",
    "Index_1",
    "Index_2",
    "Index_3",
    "Index_4",
    "Middle_1",
    "Middle_2",
    "Middle_3",
    "Middle_4",
    "Ring_1",
    "Ring_2",
    "Ring_3",
    "Ring_4",
    "Pinky_1",
    "Pinky_2",
    "Pinky_3",
    "Pinky_4",
)

# knuckles indices
KNUCKLES_INDICES = [2, 5, 9, 13, 17]

## index follows same order as previously defined JOINT_NAMES
HAND_TEMPLATE = [
    [
        [0.0, 0.0, 0.0],
        [-0.024089686572551727, -0.015522336587309837, 0.025812849402427673],
        [-0.047962214797735214, -0.03217537701129913, 0.035848069936037064],
        [-0.07330334931612015, -0.04029342159628868, 0.0409490130841732],
        [-0.1003158763051033, -0.0615660697221756, 0.038103941828012466],
        [-0.0880972295999527, -0.005200357176363468, 0.020685993134975433],
        [-0.11962570995092392, -0.014927269890904427, 0.021179750561714172],
        [-0.1269625723361969, -0.035735148936510086, 0.01877428963780403],
        [-0.1316707879304886, -0.058106984943151474, 0.02244481071829796],
        [-0.09466041624546051, -0.0014789639972150326, -0.0033575384877622128],
        [-0.12202846258878708, -0.01623973250389099, -0.009700381197035313],
        [-0.1275804340839386, -0.03875644505023956, -0.011681169271469116],
        [-0.127477765083313, -0.06481210887432098, -0.010601373389363289],
        [-0.0817355364561081, -0.00395742105320096, -0.02667318657040596],
        [-0.10585234314203262, -0.019681744277477264, -0.02843131497502327],
        [-0.11001016199588776, -0.04410919174551964, -0.027837932109832764],
        [-0.11121600866317749, -0.06724544614553452, -0.02306310087442398],
        [-0.06878694891929626, -0.009940329939126968, -0.04320933669805527],
        [-0.0828804224729538, -0.024568188935518265, -0.0489637590944767],
        [-0.08777561783790588, -0.0428570993244648, -0.048230793327093124],
        [-0.09175456315279007, -0.06212838366627693, -0.04495980963110924],
    ],
]

## RBG colors used for plotting
FINGER_COLORS = {
    "Thumb": [255, 0, 0],  # red
    "Index": [0, 255, 255],  # cian
    "Middle": [255, 255, 0],  # yellow
    "Ring": [0, 0, 255],  # blue
    "Pinky": [0, 255, 0],  # green
}


## adj matrix for graph convolutions
### conexions between joints
ADJ_INDICES = [
    [0, 0],
    [0, 1],
    [0, 1],
    [0, 5],
    [0, 5],
    [0, 9],
    [0, 9],
    [0, 13],
    [0, 13],
    [0, 17],
    [0, 17],
    [1, 0],
    [1, 0],
    [1, 1],
    [1, 2],
    [1, 2],
    [2, 1],
    [2, 1],
    [2, 2],
    [2, 3],
    [2, 3],
    [3, 2],
    [3, 2],
    [3, 3],
    [3, 4],
    [3, 4],
    [4, 3],
    [4, 3],
    [4, 4],
    [5, 0],
    [5, 0],
    [5, 5],
    [5, 6],
    [5, 6],
    [6, 5],
    [6, 5],
    [6, 6],
    [6, 7],
    [6, 7],
    [7, 6],
    [7, 6],
    [7, 7],
    [7, 8],
    [7, 8],
    [8, 7],
    [8, 7],
    [8, 8],
    [9, 0],
    [9, 0],
    [9, 9],
    [9, 10],
    [9, 10],
    [10, 9],
    [10, 9],
    [10, 10],
    [10, 11],
    [10, 11],
    [11, 10],
    [11, 10],
    [11, 11],
    [11, 12],
    [11, 12],
    [12, 11],
    [12, 11],
    [12, 12],
    [13, 0],
    [13, 0],
    [13, 13],
    [13, 14],
    [13, 14],
    [14, 13],
    [14, 13],
    [14, 14],
    [14, 15],
    [14, 15],
    [15, 14],
    [15, 14],
    [15, 15],
    [15, 16],
    [15, 16],
    [16, 15],
    [16, 15],
    [16, 16],
    [17, 0],
    [17, 0],
    [17, 17],
    [17, 18],
    [17, 18],
    [18, 17],
    [18, 17],
    [18, 18],
    [18, 19],
    [18, 19],
    [19, 18],
    [19, 18],
    [19, 19],
    [19, 20],
    [19, 20],
    [20, 19],
    [20, 19],
    [20, 20],
]
ADJ_MAT_VALUE = [
    0.16666666666666666,
    0.16666666666666666,
    0.16666666666666666,
    0.16666666666666666,
    0.16666666666666666,
    0.16666666666666666,
    0.16666666666666666,
    0.16666666666666666,
    0.16666666666666666,
    0.16666666666666666,
    0.16666666666666666,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.5,
    0.5,
    0.5,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.5,
    0.5,
    0.5,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.5,
    0.5,
    0.5,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.5,
    0.5,
    0.5,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.3333333333333333,
    0.5,
    0.5,
    0.5,
]


# BACKBONE STUFF

HRNET_W64_CONFIG_PATH = Path(
    "models/backbone/hrnet/cls_hrnet_w64_sgd_lr5e-2_wd1e-4_bs32_x100.yaml",
)
HRNET_W64_PATH = Path("models/backbone/hrnet/hrnetv2_w64_imagenet_pretrained.pth")
